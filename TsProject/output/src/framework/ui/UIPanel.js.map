{"version":3,"file":"UIPanel.js","sourceRoot":"","sources":["../../../../src/framework/ui/UIPanel.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,MAAM,YAAY,CAAC;AACnD,OAAO,EAAE,QAAQ,EAAE,MAAM,QAAQ,CAAC;AAClC,OAAO,EAAE,CAAC,EAAE,MAAM,yBAAyB,CAAC;AAC5C,OAAO,EAAE,MAAM,EAAE,MAAM,UAAU,CAAC;AAElC,OAAO,EAAE,IAAI,EAAE,MAAM,gBAAgB,CAAC;AAEtC,MAAM,OAAgB,OAAQ,SAAQ,MAAM;IAA5C;;QAMY,gBAAW,GAAgB,IAAI,IAAI,EAAE,CAAC;QACtC,kBAAa,GAAmB,IAAI,IAAI,EAAE,CAAC;QAc3C,YAAO,GAAc,UAAU,CAAC,MAAM,CAAC;IAuGnD,CAAC;IAlHG,IAAW,IAAI,CAAC,CAAQ;QACpB,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;IACnB,CAAC;IACD,IAAW,IAAI;QACX,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED,IAAW,MAAM;QACb,OAAO,SAAS,CAAC,MAAM,CAAC;IAC5B,CAAC;IAGD,IAAW,KAAK;QACZ,OAAO,IAAI,CAAC,OAAO,CAAC;IACxB,CAAC;IACD,IAAW,KAAK,CAAC,CAAc;QAC3B,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACrB,CAAC;IAED,IAAY,MAAM;QAEd,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC;IAC5B,CAAC;IAED,IAAW,OAAO,CAAC,UAAkB;QAEjC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,UAAU,CAAC;IAClC,CAAC;IAKM,SAAS,KAAG,CAAC;IAAA,CAAC;IAEd,QAAQ,KAAQ,CAAC;IAEjB,KAAK;QACR,IAAI,CAAC,OAAO,EAAE,CAAC;IAEnB,CAAC;IAEM,UAAU;QAEb,IAAG,CAAC,IAAI,CAAC,MAAM;YACX,IAAI,CAAC,MAAM,GAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC,GAAG,CAAC,CAAC;IAC5D,CAAC;IAGM,MAAM;QACT,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAED;;;OAGG;IACK,aAAa,CAAC,GAAO;QAEzB,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACrD,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAEvC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC;IAEM,KAAK,CAAC,eAAe,CAAwB,GAAU,EAAE,IAAW,EAAC,GAAa;QAErF,eAAe;QACf,IAAG,GAAG,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAC,CAAC;YACvD,MAAM,CAAC,CAAC,UAAU,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAC9B,CAAC;QAED,IAAI,IAAI,GAAC,IAAI,GAAG,EAAE,CAAC;QACnB,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAC,IAAI,CAAC,CAAC;QACxB,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC7B,OAAO,IAAI,CAAC;IAChB,CAAC;IAGM,KAAK,CAAC,MAAU,IAAI;QAEvB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAClB,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC1C,IAAG,IAAI,CAAC,MAAM,EACd,CAAC;YACG,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC3B,IAAI,CAAC,MAAM,GAAC,IAAI,CAAC;QACrB,CAAC;IAEL,CAAC;IAEM,OAAO;QAEV,aAAa;QACb,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;YAC/B,CAAC,CAAC,UAAU,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAA,EAAE;YAC/B,OAAO,CAAC,OAAO,EAAE,CAAC;YAClB,IAAG,OAAO,CAAC,MAAM,IAAE,SAAS,IAAI,OAAO,CAAC,MAAM,IAAE,IAAI,EACpD,CAAC;gBACE,OAAO,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAC3C,CAAC;YACD,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAA;QAEF,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;QACzB,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;QAC3B,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;QACnB,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;CAGJ","sourcesContent":["import { UITypeDef, UILayerDef } from \"./UIDefine\";\r\nimport { FairyGUI } from \"csharp\";\r\nimport { S } from \"../../global/GameConfig\";\r\nimport { UIBase } from \"./UIBase\";\r\nimport { UIComponent } from \"./UIComponent\";\r\nimport { List } from \"../common/List\";\r\n\r\nexport abstract class UIPanel extends UIBase {\r\n\r\n    public pkgName:string;\r\n    private _name:string;\r\n    private _timer;\r\n\r\n    private _components:List<string> = new List();\r\n    private _uiComponents:List<UIComponent>=new List();\r\n\r\n\r\n    public set name(v:string){\r\n        this._name = v;\r\n    }\r\n    public get name():string{\r\n        return this._name;\r\n    }\r\n\r\n    public get uiType(): UITypeDef {    \r\n        return UITypeDef.Unkown;\r\n    }\r\n    \r\n    private m_layer:UILayerDef = UILayerDef.Unkown;\r\n    public get layer() : UILayerDef {\r\n        return this.m_layer; \r\n    }\r\n    public set layer(v : UILayerDef) {\r\n        this.m_layer = v;\r\n    }\r\n    \r\n    public  get isOpen() : boolean{\r\n\r\n        return this.fui.visible;\r\n    }\r\n\r\n    public set visible(isActivate:boolean){\r\n\r\n        this.fui.visible = isActivate;\r\n    }\r\n\r\n    public abstract onAwake():void;\r\n    public abstract onShow(vo?:any):void;\r\n    public abstract onClose(arg?:any):void;\r\n    public onDispose(){};\r\n\r\n    public onUpdate():void{}\r\n\r\n    public awake():void{\r\n        this.onAwake();\r\n        \r\n    }\r\n\r\n    public startTimer()\r\n    {\r\n        if(!this._timer)\r\n            this._timer=setInterval(this.update.bind(this),200);\r\n    }\r\n\r\n\r\n    public update():void{\r\n        this.onUpdate();\r\n    }\r\n\r\n    /**\r\n     * 此私有方法在UI Manager中调用 ，特殊调用。\r\n     * @param arg \r\n     */\r\n    private _internalOpen(arg:any):void{\r\n        \r\n        this.layer = UILayerDef.getDefaultLayer(this.uiType);\r\n        FairyGUI.GRoot.inst.AddChild(this.fui);\r\n\r\n        this.onShow(arg);\r\n    }\r\n\r\n    public async createComponent<T extends UIComponent>(pkg:string, name:string,cls:{new():T}):Promise<T>\r\n    {\r\n        //加载组件Package资源\r\n        if(pkg != this.pkgName && !this._components.contains(pkg)){\r\n            await S.ResManager.loadFairyGUIPackage(pkg);\r\n            this._components.add(pkg);\r\n        }\r\n        \r\n        let comp=new cls();\r\n        comp.createUI(pkg,name);\r\n        this._uiComponents.add(comp);\r\n        return comp;\r\n    }\r\n\r\n\r\n    public close(arg:any = null):void{\r\n\r\n        this.onClose(arg);\r\n        FairyGUI.GRoot.inst.RemoveChild(this.fui);\r\n        if(this._timer)\r\n        {\r\n            clearInterval(this._timer);\r\n            this._timer=null;\r\n        }\r\n        \r\n    }\r\n\r\n    public dispose():void{\r\n\r\n        //卸载组件Package\r\n        this._components.foreach(element => {\r\n            S.ResManager.releaseFairyGUIPackage(element);\r\n        });\r\n        \r\n        this._uiComponents.forEach(element=>{\r\n             element.onClose();\r\n             if(element.parent!=undefined && element.parent!=null)\r\n             {\r\n                element.parent.RemoveChild(element.fui);\r\n             }\r\n             element.fui.Dispose();\r\n        })\r\n\r\n        this._components.clear();\r\n        this._uiComponents.clear();\r\n        this.fui.Dispose();\r\n        this.onDispose();\r\n    }\r\n\r\n\r\n}"]}