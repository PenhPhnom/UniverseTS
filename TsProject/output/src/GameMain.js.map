{"version":3,"file":"GameMain.js","sourceRoot":"","sources":["../../src/GameMain.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,QAAQ,EAAC,MAAM,qBAAqB,CAAC;AAC7C,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,QAAQ,CAAC;AACzD,OAAO,EAAE,QAAQ,EAAE,MAAM,4BAA4B,CAAC;AACtD,OAAO,EAAE,CAAC,EAAE,MAAM,qBAAqB,CAAC;AACxC,OAAO,EAAE,MAAM,EAAE,MAAM,2BAA2B,CAAC;AACnD,OAAO,EAAE,QAAQ,EAAE,MAAM,kBAAkB,CAAC;AAC5C,OAAO,EAAE,gBAAgB,EAAE,MAAM,yCAAyC,CAAC;AAI3E,MAAM,QAAQ;IAEV;QACI,SAAS,CAAC,QAAQ,CAAC,mBAAmB,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACxE,SAAS,CAAC,QAAQ,CAAC,WAAW,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;IAC5D,CAAC;IAEM,KAAK,CAAC,KAAK;QAEd,IAAG,CAAC;YACA,MAAM,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;YAGnC,CAAC,CAAC,YAAY,CAAC,UAAU,EAAE,CAAC;YAG5B,YAAY;YACZ,sCAAsC;YAEtC,gBAAgB;YAChB,MAAM,CAAC,CAAC,UAAU,CAAC,mBAAmB,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YAE7D,cAAc;YACd,QAAQ,CAAC,MAAM,EAAE,CAAC;YAElB,QAAQ;YACR,MAAM,CAAC,CAAC,YAAY,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAGpD,cAAc;YACd,UAAU,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC;YAErC,IAAI,OAAO,GAAG,GAAE,EAAE;gBACd,IAAI,IAAI,GAAI,IAAI,gBAAgB,EAAE,CAAC;gBACpC,kBAAkB;gBACjB,OAAO,IAAI,CAAC;YAChB,CAAC,CAAA;YAEF,gBAAgB;YACf,QAAQ,CAAC,eAAe,CAAC,uBAAuB,CAAC,qBAAqB,EAAC,OAAO,CAAC,CAAA;QAGnF,CAAC;QAAA,OAAM,EAAE,EAAC,CAAC;YACP,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QACrB,CAAC;IAEL,CAAC;IAEM,iBAAiB;QAEpB,CAAC,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC/B,MAAM,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;IACnD,CAAC;IAEM,SAAS;QAEZ,MAAM,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;IAC3C,CAAC;CAEJ;AAED,IAAI,QAAQ,EAAE,CAAC,KAAK,EAAE,CAAC","sourcesContent":["\r\nimport {UnitTest} from './unittest/UnitTest';\r\nimport { JsManager ,GameLaunch, FairyGUI } from 'csharp';\r\nimport { SceneDef } from './framework/scene/SceneDef';\r\nimport { S } from './global/GameConfig';\r\nimport { Logger } from './framework/logger/Logger';\r\nimport { commonUI } from './data/ui/common';\r\nimport { UIServerListItem } from './game/module/login/ui/UIServerListItem';\r\n\r\n\r\n\r\nclass GameMain{\r\n\r\n    constructor() {\r\n        JsManager.Instance.JsOnApplicationQuit = () => this.onApplicationQuit();\r\n        JsManager.Instance.JsOnDispose = () => this.onDispose();\r\n    }\r\n\r\n    public async start() {\r\n        \r\n        try{\r\n            Logger.log(\"Game start in JS....\");\r\n\r\n            \r\n            S.StoryManager.initialize();\r\n\r\n\r\n            //预加载excel数据\r\n            //ExcelManager.Instance(ExcelManager);\r\n      \r\n            //加载通用FairyGUI资源\r\n            await S.ResManager.loadFairyGUIPackage(commonUI.PackageName);\r\n\r\n            //do Unit Test\r\n            UnitTest.doTest();\r\n\r\n            //进入登录模块\r\n            await S.SceneManager.loadScene(SceneDef.LoginScene);\r\n\r\n            \r\n            //JS启动完成，通知C#层\r\n            GameLaunch.Instance.JsLuanchFinish();\r\n\r\n            let extItem = ()=>{\r\n                let item =  new UIServerListItem();\r\n               // pool.push(item)\r\n                return item;\r\n            }\r\n\r\n           // let pool = []\r\n            FairyGUI.UIObjectFactory.SetPackageItemExtension(\"ui://l64dumk9feeg54\",extItem)\r\n            \r\n\r\n        }catch(ex){\r\n            Logger.error(ex);\r\n        }\r\n\r\n    }\r\n\r\n    public onApplicationQuit():void {\r\n\r\n        S.GameObjectPool.cleanup(true);\r\n        Logger.log(\"Game onApplicationQuit in JS....\");\r\n    }\r\n\r\n    public onDispose():void {\r\n        \r\n        Logger.log(\"Game onDispose in JS....\");\r\n    }\r\n    \r\n}\r\n\r\nnew GameMain().start();\r\n\r\n"]}